from fractions import Fraction
from typing import Literal, Optional, Union

from boiling_learning.preprocessing.image import (
    VideoFrameOrFrames,
    center_cropper,
    cropper,
    downscaler,
    grayscaler,
    image_dtype_converter,
    random_cropper,
)
from boiling_learning.preprocessing.transformers import Transformer

ExperimentVideoName = str

# equal to Hobold's:
RECOMMENDED_DIRECT_HEIGHT = 120
RECOMMENDED_INDIRECT_HEIGHT = 72
RECOMMENDED_WIDTH = 196


def main(
    direct_visualization: bool = True,
    downscale_factor: int = 4,
    height: Optional[int] = None,
    bottom_border: Optional[int] = None,
    width: int = RECOMMENDED_WIDTH,
    visualization_window_width: Fraction = Fraction(60, 100),
    crop_mode: Literal['center', 'random'] = 'center',
) -> list[
    Union[
        Transformer[VideoFrameOrFrames, VideoFrameOrFrames],
        dict[ExperimentVideoName, Transformer[VideoFrameOrFrames, VideoFrameOrFrames]],
    ]
]:
    if height is None:
        height = RECOMMENDED_DIRECT_HEIGHT if direct_visualization else RECOMMENDED_INDIRECT_HEIGHT

    if bottom_border is None:
        bottom_border = RECOMMENDED_DIRECT_HEIGHT - height

    return [
        image_dtype_converter('float32'),
        {
            'GOPR2819': cropper(left=861, right=1687, top=321, bottom=1150),
            'GOPR2820': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2821': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2822': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2823': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2824': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2825': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2826': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2827': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2828': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2829': cropper(left=861, right=1678, top=321, bottom=1140),
            'GOPR2830': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2831': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2832': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2833': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2834': cropper(left=880, right=1678, top=350, bottom=1130),
            'GOPR2835': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2836': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2837': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2838': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2839': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2840': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2841': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2842': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2843': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2844': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2845': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2846': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2847': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2848': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2849': cropper(left=880, right=1678, top=350, bottom=1140),
            'GOPR2852': cropper(left=1010, right=1865, top=150, bottom=1120),
            'GOPR2853': cropper(left=1010, right=1865, top=150, bottom=1120),
            'GOPR2854': cropper(left=1020, right=1865, top=150, bottom=1120),
            'GOPR2855': cropper(left=1020, right=1865, top=150, bottom=1120),
            'GOPR2856': cropper(left=1040, right=1890, top=150, bottom=1120),
            'GOPR2857': cropper(left=1040, right=1890, top=150, bottom=1120),
            'GOPR2858': cropper(left=1040, right=1890, top=150, bottom=1120),
            'GOPR2859': cropper(left=1040, right=1890, top=150, bottom=1120),
            'GOPR2860': cropper(left=1040, right=1890, top=150, bottom=1120),
            'GOPR2861': cropper(left=1040, right=1890, top=150, bottom=1120),
            'GOPR2862': cropper(left=1040, right=1890, top=250, bottom=1120),
            'GOPR2863': cropper(left=1040, right=1890, top=250, bottom=1120),
            'GOPR2864': cropper(left=1040, right=1890, top=250, bottom=1120),
            'GOPR2865': cropper(left=1040, right=1890, top=340, bottom=1120),
            'GOPR2866': cropper(left=1040, right=1890, top=340, bottom=1120),
            'GOPR2867': cropper(left=1040, right=1890, top=340, bottom=1120),
            'GOPR2868': cropper(left=1040, right=1890, top=340, bottom=1120),
            'GOPR2869': cropper(left=1040, right=1890, top=340, bottom=1120),
            'GOPR2870': cropper(left=1040, right=1890, top=340, bottom=1120),
            'GOPR2873': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2874': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2875': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2876': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2877': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2878': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2879': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2880': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2881': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2882': cropper(left=990, right=1780, top=350, bottom=1220),
            'GOPR2884': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2885': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2886': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2887': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2888': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2889': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2890': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2891': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2892': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2893': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2894': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2895': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2896': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2897': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2898': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2899': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2900': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2901': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2902': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2903': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2904': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2905': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2906': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2907': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2908': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2909': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2910': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2911': cropper(left=960, right=1750, top=450, bottom=1250),
            'GOPR2914': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2915': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2916': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2917': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2918': cropper(left=960, right=1750, top=400, bottom=1250),
            'GOPR2919': cropper(left=960, right=1750, top=450, bottom=1250),
            'GOPR2920': cropper(left=960, right=1750, top=450, bottom=1250),
            'GOPR2921': cropper(left=960, right=1750, top=450, bottom=1250),
            'GOPR2922': cropper(left=960, right=1750, top=450, bottom=1250),
            'GOPR2923': cropper(left=960, right=1750, top=450, bottom=1250),
            'GOPR2925': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2926': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2927': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2928': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2929': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2930': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2931': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2932': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2933': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2934': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2935': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2936': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2937': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2938': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2939': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2940': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2941': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2942': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2943': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2944': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2945': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2946': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2947': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2948': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2949': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2950': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2951': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2952': cropper(left=980, right=1810, top=300, bottom=1200),
            'GOPR2953': cropper(left=980, right=1810, top=400, bottom=1200),
            'GOPR2954': cropper(left=980, right=1810, top=400, bottom=1200),
            'GOPR2955': cropper(left=980, right=1810, top=400, bottom=1200),
            'GOPR2956': cropper(left=980, right=1810, top=400, bottom=1200),
            'GOPR2957': cropper(left=980, right=1810, top=400, bottom=1200),
            'GOPR2959': cropper(left=980, right=1810, top=400, bottom=1200),
            'GOPR2960': cropper(left=980, right=1810, top=400, bottom=1200),
        },
        grayscaler(),
        downscaler(downscale_factor),
        cropper(height=height, bottom_border=bottom_border),
        {'center': center_cropper, 'random': random_cropper}[crop_mode](
            width=round(width * visualization_window_width)
        ),
    ]
